---
title: Android 15 MTK平台 OS系统 开发者选项中刷新率显示控制
slug: cbee4ebec8134ac591f14c6c485103e0
tags:
  - android
date: 2026-01-26T03:37:04.833Z
---

## 概要

本次修改为**LCOS\_Settings**模块中的“显示刷新率”选项添加了**宏控制开关**，使其可根据系统属性 `ro.kte.show_refresh_rate` 决定是否在开发者选项中显示。

## 涉及文件

1. `config.xml` – 新增宏控制属性配置

2. `ShowRefreshRatePreferenceController.java` – 新增 `isAvailable()` 方法，根据宏判断是否显示

## 完整 diff 内容

```diff
commit 4b6a3e6caf4a8b5c32b39507f7936f79314bf970
Author: zhangkai <zhangkai@kingtop-group.com>
Date:   Thu Jan 15 12:15:10 2026 +0800

    [os][LCOS_Settings]开发者选项中是否显示屏刷新率用宏控制

diff --git a/system/vendor/lcos/openSource/LCOS_Settings/res/values/config.xml b/system/vendor/lcos/openSource/LCOS_Settings/res/values/config.xml
index 4b638b25552..91d97ee2704 100644
--- a/system/vendor/lcos/openSource/LCOS_Settings/res/values/config.xml
+++ b/system/vendor/lcos/openSource/LCOS_Settings/res/values/config.xml
@@ -826,6 +826,11 @@
     <!-- Whether to display pSIM conversion menu in Settings.-->
     <bool name="config_psim_conversion_menu_enabled">false</bool>
 
+    <!-- kte modified by <zhangkai>@<20260104> for <hide refres rate> start -->
+    <!-- Whether to display refresh rate menu in Settings.-->
+    <string name="config_refresh_rate_prop">ro.kte.show_refresh_rate</string>
+    <!-- kte modified by <zhangkai>@<20260104> for <hide refres rate> end -->
+
     <!-- Array of carrier id to allow the pSIM conversion-->
     <integer-array name="config_psim_conversion_menu_enabled_carrier" translatable="false">
     </integer-array>
diff --git a/system/vendor/lcos/openSource/LCOS_Settings/src/com/android/settings/development/ShowRefreshRatePreferenceController.java b/system/vendor/lcos/openSource/LCOS_Settings/src/com/android/settings/development/ShowRefreshRatePreferenceController.java
index 4d522527d34..797f93839db 100644
--- a/system/vendor/lcos/openSource/LCOS_Settings/src/com/android/settings/development/ShowRefreshRatePreferenceController.java
+++ b/system/vendor/lcos/openSource/LCOS_Settings/src/com/android/settings/development/ShowRefreshRatePreferenceController.java
@@ -28,6 +28,10 @@ import androidx.preference.TwoStatePreference;
 
 import com.android.settings.core.PreferenceControllerMixin;
 import com.android.settingslib.development.DeveloperOptionsPreferenceController;
+//kte modified by <zhangkai>@<20260104> for <hide refres rate> start
+import com.android.settings.R;
+import android.os.SystemProperties;
+//kte modified by <zhangkai>@<20260104> for <hide refres rate> end
 
 /**
  * Controller class for controlling the refresh rate overlay on SurfaceFlinger
@@ -121,4 +125,11 @@ public class ShowRefreshRatePreferenceController extends DeveloperOptionsPrefere
         }
         updateShowRefreshRateSetting();
     }
+
+    //kte modified by <zhangkai>@<20260104> for <hide refres rate> start
+    @Override
+    public boolean isAvailable() {
+        return SystemProperties.getBoolean(mContext.getString(R.string.config_refresh_rate_prop), false);
+    }
+    //kte modified by <zhangkai>@<20260104> for <hide refres rate> end
 }

```

## 修改说明

### 1. **config.xml 新增配置项**

- 增加字符串资源 `config_refresh_rate_prop`，值为 `ro.kte.show_refresh_rate`

- 该属性用于在系统中控制是否显示“刷新率”菜单

### 2. **ShowRefreshRatePreferenceController.java 新增控制逻辑**

- 导入 `R` 和 `SystemProperties` 类

- 重写 `isAvailable()` 方法：

  - 读取系统属性 `ro.kte.show_refresh_rate`

  - 默认值为 `false`（即默认隐藏）

  - 若属性值为 `true`，则显示该选项

## 影响范围

- 仅影响**开发者选项**中的“显示刷新率”菜单项

- 通过系统属性动态控制显示/隐藏，便于产品配置与客制化

## 测试建议

- 设置 `ro.kte.show_refresh_rate=true`，检查是否显示

- 设置 `ro.kte.show_refresh_rate=false`，检查是否隐藏

- 默认不设属性时应为隐藏状态
