---
title: SSH å…å¯†ç™»å½•é…ç½®æŒ‡å—
slug: 374ef7a12c994f7aa60eb382c1476948
tags:
  - linux
  - ssh
date: 2025-06-09T12:30:27.475Z
---

## 1. ç”Ÿæˆå¯†é’¥å¯¹

```bash
ssh-keygen -t rsa
```

- **å…¨ç¨‹å›è½¦ç¡®è®¤**ï¼ˆä¸è®¾å¯†ç ï¼‰

- é»˜è®¤ç”Ÿæˆæ–‡ä»¶ï¼š\
  ğŸ”‘ ç§é’¥ï¼š`~/.ssh/id_rsa`\
  ğŸ“„ å…¬é’¥ï¼š`~/.ssh/id_rsa.pub`

***

## 2. ä¸Šä¼ å…¬é’¥åˆ°è¿œç¨‹ä¸»æœº

### æ–¹æ³•ä¸€ï¼šç›´æ¥å¤åˆ¶ï¼ˆæ¨èï¼‰

```bash
scp ~/.ssh/id_rsa.pub username@hostname:~/.ssh/authorized_keys
```

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨è¿½åŠ 

```bash
# 1. å¤åˆ¶å…¬é’¥åˆ°è¿œç¨‹ä¸»æœº
scp ~/.ssh/id_rsa.pub username@hostname:~

# 2. ç™»å½•è¿œç¨‹ä¸»æœº
ssh username@hostname

# 3. è¿½åŠ å…¬é’¥ï¼ˆè‹¥ç›®å½•ä¸å­˜åœ¨éœ€å…ˆåˆ›å»ºï¼‰
mkdir -p ~/.ssh
cat ~/id_rsa.pub >> ~/.ssh/authorized_keys

# 4. è®¾ç½®æƒé™ï¼ˆå…³é”®ï¼ï¼‰
chmod 700 ~/.ssh
chmod 600 ~/.ssh/authorized_keys
```

***

## 3. å¤šä¸»æœºé…ç½®ï¼ˆæœ¬åœ°ç”¨æˆ·â‰ è¿œç¨‹ç”¨æˆ·æ—¶ï¼‰

åˆ›å»º/ä¿®æ”¹ `~/.ssh/config` æ–‡ä»¶ï¼š

```config
# ç¤ºä¾‹é…ç½®
Host server1         # è‡ªå®šä¹‰ä¸»æœºåˆ«å
  HostName host1.com # å®é™…IP/åŸŸå
  User user1         # è¿œç¨‹ç”¨æˆ·å

Host server2
  HostName 192.168.1.100
  User admin
```

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
ssh server1  # è‡ªåŠ¨ä½¿ç”¨ user1@host1.com
```

***

## ğŸ”§ éªŒè¯ä¸æ’é”™

```bash
ssh -T username@hostname
```

- **å¸¸è§é”™è¯¯**ï¼š

  1. è¿œç¨‹ `.ssh` ç›®å½•æƒé™éœ€ä¸º `700`

  2. `authorized_keys` æ–‡ä»¶æƒé™éœ€ä¸º `600`

  3. ç¡®ä¿ SELinux æœªé˜»æ­¢æ“ä½œï¼ˆä¸´æ—¶ç¦ç”¨ `setenforce 0` æµ‹è¯•ï¼‰

***

## ğŸŒŸ é«˜çº§æŠ€å·§

### æ‰¹é‡éƒ¨ç½²åˆ°å¤šä¸»æœº

```bash
for host in host1 host2 host3; do
  ssh-copy-id -i ~/.ssh/id_rsa.pub user@$host
done
```

### æŒ‡å®šä¸åŒå¯†é’¥

åœ¨ `~/.ssh/config` ä¸­æ·»åŠ ï¼š

```config
Host special-server
  IdentityFile ~/.ssh/special_key
```

> **æ³¨æ„äº‹é¡¹**
>
> 1. é¦–æ¬¡è¿æ¥éœ€æ‰‹åŠ¨ç¡®è®¤ä¸»æœºæŒ‡çº¹
> 2. ç”Ÿäº§ç¯å¢ƒå»ºè®®ä¸ºå¯†é’¥è®¾ç½®å¯†ç ï¼ˆç”¨ `ssh-agent` ç®¡ç†ï¼‰
> 3. `config` æ–‡ä»¶æƒé™éœ€ä¸º `600`ï¼š`chmod 600 ~/.ssh/config`
> 4. è¿œç¨‹ä¸»æœºéœ€å¯ç”¨ `RSAAuthentication yes` å’Œ `PubkeyAuthentication yes`ï¼ˆé»˜è®¤å¼€å¯ï¼‰
