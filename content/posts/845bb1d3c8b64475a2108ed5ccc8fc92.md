---
title: Linux å®šæ—¶æ‰§è¡Œ Shell è„šæœ¬æŒ‡å—
slug: 845bb1d3c8b64475a2108ed5ccc8fc92
tags:
  - linux
date: 2025-06-10T01:41:57.138Z
---

## ğŸ“Œ æ ¸å¿ƒæ–¹æ³•ï¼šcron æœåŠ¡

### 1. ç”¨æˆ·çº§å®šæ—¶ä»»åŠ¡ (`crontab`)

```bash
# ç¼–è¾‘å½“å‰ç”¨æˆ·çš„å®šæ—¶ä»»åŠ¡
crontab -e
```

**åŸºæœ¬æ ¼å¼**ï¼š

```bash
* * * * * command_to_execute
â”¬ â”¬ â”¬ â”¬ â”¬
â”‚ â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ â””â”€ æ˜ŸæœŸå‡  (0-6) 0=å‘¨æ—¥
â”‚ â”‚ â”‚ â””â”€â”€â”€ æœˆä»½ (1-12)
â”‚ â”‚ â””â”€â”€â”€â”€â”€ æ—¥ (1-31)
â”‚ â””â”€â”€â”€â”€â”€â”€â”€ å°æ—¶ (0-23)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€ åˆ†é’Ÿ (0-59)
```

### å¸¸ç”¨ç¤ºä¾‹

```bash
# æ¯å¤© 02:30 æ‰§è¡Œ
30 2 * * * /bin/bash /home/user/backup.sh

# æ¯ 10 åˆ†é’Ÿæ‰§è¡Œ
*/10 * * * * /bin/bash /scripts/monitor.sh

# æ¯å‘¨ä¸€ 08:00 æ‰§è¡Œ
0 8 * * 1 /bin/bash /scripts/weekly_report.sh

# æ¯å¤© 12:00 å’Œ 18:00 æ‰§è¡Œ
0 12,18 * * * /bin/bash /scripts/daily_task.sh
```

### 2. ç³»ç»Ÿçº§å®šæ—¶ä»»åŠ¡

```bash
# å°†è„šæœ¬æ”¾å…¥å¯¹åº”ç›®å½•
sudo mv script.sh /etc/cron.daily/    # æ¯å¤©æ‰§è¡Œ
sudo chmod +x /etc/cron.daily/script.sh
```

å¯ç”¨ç›®å½•ï¼š

- `/etc/cron.hourly/`

- `/etc/cron.daily/`

- `/etc/cron.weekly/`

- `/etc/cron.monthly/`

***

## âš ï¸ å…³é”®æ³¨æ„äº‹é¡¹

1. **è·¯å¾„é—®é¢˜**

   - âœ… ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼š`/home/user/script.sh`

   - âŒ é¿å…ç›¸å¯¹è·¯å¾„ï¼š`./script.sh` æˆ– `~/script.sh`

2. **æƒé™è®¾ç½®**

   ```bash
   chmod +x /path/to/your_script.sh
   ```

3. **ç¯å¢ƒå˜é‡**

   ```bash
   # åœ¨ crontab é¡¶éƒ¨è®¾ç½®ç¯å¢ƒå˜é‡
   SHELL=/bin/bash
   PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
   ```

4. **æ—¥å¿—è®°å½•**

   ```bash
   # é‡å®šå‘è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶
   * * * * * /bin/bash /scripts/task.sh >> /var/log/cron.log 2>&1
   ```

***

## ğŸ” è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹ cron æ—¥å¿—

```bash
# Ubuntu/Debian
grep CRON /var/log/syslog

# CentOS/RHEL
tail -f /var/log/cron
```

### æµ‹è¯•è„šæœ¬ç¯å¢ƒ

```bash
# æ¨¡æ‹Ÿ cron ç¯å¢ƒæ‰§è¡Œ
env -i /bin/bash /path/to/script.sh
```

***

## â±ï¸ å•æ¬¡ä»»åŠ¡å·¥å…· `at`

```bash
# 2 å°æ—¶åæ‰§è¡Œ
echo "/path/to/script.sh" | at now + 2 hours

# æŸ¥çœ‹é˜Ÿåˆ—
atq

# åˆ é™¤ä»»åŠ¡ (ID=2)
atrm 2
```

***

## ğŸ’¡ æœ€ä½³å®è·µ

1. æ‰€æœ‰è„šæœ¬ä½¿ç”¨å®Œæ•´è·¯å¾„

2. è„šæœ¬å¼€å¤´è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

   ```bash
   #!/bin/bash
   export PATH=/usr/local/bin:/bin:/usr/bin
   ```

3. æ·»åŠ æ‰§è¡Œæ—¥å¿—è®°å½•ï¼š

   ```bash
   echo "[$(date)] è„šæœ¬å¯åŠ¨" >> $LOG_FILE
   ```

4. æµ‹è¯•æ—¶ä½¿ç”¨æ¯åˆ†é’Ÿä»»åŠ¡éªŒè¯ï¼š

   ```bash
   * * * * * /bin/bash /path/to/test.sh
   ```

***

> **ğŸ“ å…³è”èµ„æº**
>
> 1. [Cron è¡¨è¾¾å¼ç”Ÿæˆå™¨](https://crontab.guru/)
>
> 2. `man 5 crontab` æŸ¥çœ‹æ‰‹å†Œ
