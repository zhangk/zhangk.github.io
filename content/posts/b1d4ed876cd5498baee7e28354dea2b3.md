---
title: Debian 12 安装 NVIDIA 显卡驱动
slug: b1d4ed876cd5498baee7e28354dea2b3
tags:
  - linux
date: 2025-08-04T07:39:57.381Z
---

## 一、准备工作

### 1. 关闭Secure Boot

1. 进入BIOS关闭Secure Boot

2. 验证关闭状态：

   ```bash
   mokutil --sb-state
   ```

### 2. 检查GPU识别

```bash
lspci | grep -E "VGA|3D"
```

- 正常输出示例：`01:00.0 VGA compatible controller: NVIDIA Corporation AD107 [GeForce RTX 4060] (rev a1)`

### 3. 安装依赖

```bash
sudo apt install -y linux-headers-$(uname -r) dkms gcc acpid \
libglvnd-core-dev libglvnd0 libglvnd-dev pkg-config
```

- 若报错先修复：`sudo apt --fix-broken install`

### 4. 卸载旧驱动（可选）

```bash
sudo apt --purge remove "*nvidia*" "*libxnvctrl*"
sudo apt autoremove
```

### 5. 下载驱动

1. 从[NVIDIA官网](https://www.nvidia.com/Download/index.aspx)下载对应驱动

2. 禁用广告拦截插件避免下载问题

3. 保存到用户目录（如：`~/NVIDIA-Linux-x86_64-570.144.run`）

### 8. 切换至命令行界面

```bash
sudo systemctl set-default multi-user.target
sudo reboot
```

***

## 二、安装驱动

### 1. 赋予执行权限

```bash
sudo chmod a+x ~/NVIDIA-Linux-x86_64-*.run
```

### 2. 运行安装程序

```bash
sudo ~/NVIDIA-Linux-x86_64-*.run
```

### 3. 安装选项配置

1. 自动构建内核模块 → 确认

2. **安装32位库** → 根据需求选Yes/No

3. **使用DKMS编译** → 强烈建议选Yes

4. **重建initramfs** → 建议选Yes

5. **关键选择**：

   - 单显卡 → `Yes`（使用NVIDIA渲染图形界面）

   - 双显卡（核显+独显） → `No`（避免黑屏）

### 4. 恢复图形界面

```bash
sudo systemctl set-default graphical.target
sudo reboot
```

***

## 三、验证安装

bash

```
nvidia-smi
```

- 单显卡正常输出：包含GPU信息和运行进程（除Xorg外应有其他进程）

- 双显卡可能只显示驱动版本无进程（正常现象）

***

## 四、问题解决

### 1. 卸载.run驱动

```bash
sudo nvidia-uninstall
```

- 根据安装时的xconf配置选择：

  - 未生成xconf → 选No

  - 生成过xconf → 选Yes（还原默认配置）

### 2. 开机黑屏处理（双显卡误配）

1. 按 `Ctrl+Alt+F2` 进入终端

2. 查询显卡ID：

   ```bash
   lspci | grep -E "VGA|3D"
   ```

   （示例输出：核显 `00:02.0` → ID: `0:2:0`）

3. 修改Xorg配置：

   ```bash
   sudo vi /etc/X11/xorg.conf
   ```

   修改为：

   ```conf
   Section "Device"
       Identifier  "Device0"
       Driver      "modesetting"
       BusID       "PCI:0:2:0"  # 替换为核显ID
   EndSection
   ```

### 3. 循环登录问题

修改GRUB配置：

```bash
sudo vi /etc/default/grub
```

添加参数：

```conf
GRUB_CMDLINE_LINUX_DEFAULT="quiet splash nvidia-drm.modeset=1"
```

```bash
sudo update-grub
```

### 4. 通用xorg.conf配置

```conf
Section "Device"
    Identifier  "Device0"
    Driver      "modesetting"
    Option      "AccelMethod" "none"
EndSection
```

***

## 注意事项

1. 双显卡设备安装时**务必**拒绝生成xorg配置（选No）

2. 内核升级后需重新安装驱动（DKMS会自动处理）

3. 推荐使用官网最新驱动（旧驱动可能不支持新显卡）

4. 笔记本用户建议额外安装`nvidia-settings`进行电源管理

> **重要提示**：双显卡设备在安装过程中的第5步（是否生成xorg配置）必须选择 **No**，否则会导致黑屏问题。安装完成后可通过`prime-select`或`nvidia-settings`切换显卡。
